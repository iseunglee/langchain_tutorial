# api_key
from dotenv import load_dotenv
import os

load_dotenv()
API_KEY = os.getenv("OPENAI_API_KEY")

# main.py 시작하는 파일 이름
from langchain.callbacks.base import BaseCallbackHandler #
from langchain.chat_models import ChatOpenAI
from langchain.schema import ChatMessage
import streamlit as st

MODEL = "gpt-4-0125-preview"

class StreamHandler(BaseCallbackHandler):
    def __init__(self, container, initial_text=""):
        self.container = container
        self.text = initial_text

    def on_llm_new_token(self, token: str, **kwargs) -> None:
        self.text += token
        self.container.markdown(self.text)

want_to = """너는 아래 내용을 기반으로 질의응답을 하는 로봇이야.
content
{}
"""

content="""
motor_type,watt,3PH/1PH,esp,air_velocity,power_consumption,current,power_factor,noise,vibration,filter_type,filter_thickness,filter_pressure,spec
BLDC,502,1PH,11,0.7,600,3.73,86,61,1,ULPA,75t,13.5,a
AC,422,1PH,9,0.7,599,3.44,84,63,1,ULPA,75t,14,a
BLDC,631,1PH,10,0.7,598,3.39,97,56,1,ULPA,120t,13.5,a
BLDC,542,3PH,8,0.5,585,3.13,85,52,1,ULPA,75t,13,a
BLDC,472,3PH,9,0.5,472,1.78,65,50,0.81,HEPA,75t,13,a
BLDC,387,1PH,10,0.7,584,3.34,88,59,0.99,ULPA,75t,13.5,a
BLDC,470,3PH,10,0.7,578,3.33,79,56,0.99,ULPA,120t,13.5,a
BLDC,380,1PH,10,0.7,572,3.28,78,58,0.99,HEPA,75t,13,a
BLDC,628,1PH,10,0.7,570,3.22,92,56,0.98,HEPA,120t,13.1,a
BLDC,575,1PH,9,0.7,569,3.21,82,63,0.98,ULPA,75t,13,a
BLDC,556,3PH,9,0.6,564,3.18,85,61,0.97,HEPA,120t,13.5,a
AC,532,1PH,11,0.6,562,3.1,87,59,0.96,ULPA,120t,13.5,a
BLDC,563,1PH,10,0.6,561,3.09,81,50,0.96,HEPA,120t,13,a
AC,527,3PH,11,0.6,558,3.05,97,53,0.95,HEPA,120t,13,a
BLDC,519,1PH,11,0.6,553,3.03,86,60,0.95,HEPA,75t,13,a
BLDC,548,1PH,11,0.6,547,3.01,99,58,0.9,HEPA,75t,13,a
BLDC,548,3PH,12,0.6,547,2.96,96,56,0.9,ULPA,75t,14,a
BLDC,399,1PH,11,0.6,547,2.96,82,57,0.9,ULPA,120t,15,a
BLDC,555,1PH,10,0.6,546,2.93,81,57,0.9,ULPA,120t,13,a
AC,481,3PH,12,0.6,541,2.93,96,61,0.88,HEPA,75t,15,a
AC,534,1PH,10,0.6,532,2.93,86,62,0.88,HEPA,120t,9,a
AC,632,1PH,12,0.6,526,2.89,94,57,0.88,ULPA,120t,10,a
BLDC,606,1PH,10,0.6,516,2.89,81,50,0.87,HEPA,120t,10,a
BLDC,600,3PH,11,0.6,516,2.87,86,56,0.87,ULPA,120t,13.5,a
AC,445,3PH,11,0.6,516,2.88,96,63,0.87,ULPA,120t,13.5,a
BLDC,612,1PH,12,0.6,513,2.87,79,60,0.87,HEPA,75t,13.5,a
BLDC,454,3PH,10,0.6,508,2.85,78,63,0.87,HEPA,120t,12.5,a
AC,430,3PH,10,0.6,508,2.87,78,55,0.87,HEPA,120t,13,a
AC,508,3PH,10,0.6,494,2.8,80,56,0.85,ULPA,120t,13.5,a
BLDC,477,1PH,12,0.6,489,2.79,85,62,0.85,HEPA,75t,13.5,a
BLDC,456,1PH,12,0.5,480,2.76,95,52,0.84,ULPA,120t,9,a
AC,600,1PH,9,0.5,477,2.73,87,55,0.84,ULPA,120t,12.5,a
BLDC,586,3PH,11,0.5,476,2.72,98,56,0.84,HEPA,75t,13.5,a
BLDC,431,1PH,9,0.5,475,2.71,91,60,0.84,HEPA,75t,12,a
AC,601,1PH,9,0.5,474,2.7,100,64,0.84,ULPA,120t,12,a
AC,477,1PH,11,0.5,472,2.68,84,63,0.84,HEPA,120t,13.5,a
BLDC,617,1PH,12,0.5,468,2.67,100,61,0.84,ULPA,75t,12,a
BLDC,394,1PH,9,0.5,467,2.67,96,53,0.84,ULPA,75t,12,a
AC,502,3PH,10,0.5,466,2.67,96,56,0.83,ULPA,75t,13.5,a
BLDC,552,3PH,11,0.5,460,2.66,80,56,0.83,HEPA,75t,9,a
AC,438,1PH,11,0.5,460,2.65,88,59,0.83,ULPA,120t,12,a
BLDC,538,1PH,9,0.5,457,2.65,96,60,0.83,ULPA,75t,13,a
BLDC,413,1PH,12,0.5,456,2.65,81,62,0.83,HEPA,120t,10,a
AC,440,1PH,12,0.5,452,2.64,99,63,0.83,HEPA,75t,8,a
BLDC,583,3PH,10,0.5,450,2.64,100,60,0.83,HEPA,120t,12.5,a
BLDC,625,3PH,10,0.5,448,2.63,98,58,0.83,ULPA,120t,12.5,a
AC,444,3PH,11,0.5,448,2.63,92,53,0.83,HEPA,120t,12.5,a
BLDC,644,1PH,9,0.5,446,2.62,95,52,0.82,ULPA,120t,12,a
BLDC,540,3PH,9,0.5,446,2.63,81,63,0.82,HEPA,120t,13.5,a
BLDC,388,3PH,9,0.5,445,2.62,82,61,0.82,ULPA,120t,13,a
AC,402,1PH,12,0.5,444,2.62,85,60,0.82,HEPA,75t,12.5,a
BLDC,422,1PH,12,0.5,443,2.61,83,53,0.82,HEPA,120t,14,a
AC,574,3PH,9,0.4,409,2.41,91,50,0.7,ULPA,75t,13.5,a
BLDC,533,3PH,12,0.4,407,2.41,88,64,0.68,ULPA,120t,10,a
AC,599,3PH,9,0.4,405,2.4,89,61,0.68,HEPA,120t,9,a
BLDC,451,3PH,9,0.4,405,2.39,83,57,0.67,HEPA,75t,11,a
AC,571,1PH,9,0.4,403,2.35,99,50,0.67,ULPA,75t,13,a
BLDC,510,3PH,9,0.4,403,2.33,78,54,0.66,HEPA,75t,12.5,a
BLDC,505,1PH,12,0.4,403,2.34,87,62,0.66,ULPA,75t,13.5,a
BLDC,388,3PH,9,0.4,403,2.34,78,55,0.65,HEPA,75t,13,a
AC,528,3PH,9,0.4,400,2.33,85,51,0.63,HEPA,75t,12.5,a
BLDC,399,3PH,11,0.3,598,1.98,76,60,1,HEPA,75t,11,b
AC,515,1PH,9,0.7,575,3.29,93,62,0.99,HEPA,120t,10,b
AC,451,3PH,12,0.6,567,3.19,80,58,0.98,HEPA,75t,11.5,b
BLDC,332,3PH,10,0.3,563,1.92,91,66,0.97,ULPA,120t,11.5,b
AC,644,3PH,9,0.6,550,3.01,99,51,0.93,HEPA,120t,12.5,b
BLDC,348,1PH,12,0.4,548,2.18,79,59,0.93,ULPA,75t,9,b
BLDC,354,1PH,10,0.5,538,2.57,76,63,0.88,ULPA,120t,12.5,b
AC,318,3PH,10,0.2,511,1.59,78,61,0.87,ULPA,120t,8.5,b
BLDC,474,3PH,11,0.5,481,2.79,85,61,0.84,ULPA,120t,7.5,b
BLDC,444,1PH,10,0.5,480,2.76,87,55,0.84,HEPA,75t,12,b
BLDC,412,1PH,12,0.5,441,2.58,77,66,0.8,ULPA,75t,11.5,b
BLDC,357,1PH,12,0.5,441,2.59,95,66,0.8,ULPA,120t,12,b
BLDC,281,1PH,12,0.5,436,2.55,92,61,0.8,ULPA,75t,11.5,b
AC,395,1PH,10,0.5,435,2.55,79,58,0.79,HEPA,120t,11,b
BLDC,321,1PH,13,0.5,435,2.54,88,58,0.79,HEPA,120t,12.5,b
AC,410,1PH,10,0.5,434,2.52,93,64,0.79,HEPA,75t,11.5,b
BLDC,411,3PH,11,0.5,429,2.51,84,59,0.78,ULPA,75t,12.5,b
BLDC,289,1PH,10,0.2,411,1.68,79,64,0.7,ULPA,75t,11.5,b
AC,333,1PH,12,0.4,398,2.3,85,61,0.62,ULPA,75t,10,b
BLDC,322,1PH,12,0.4,397,2.28,75,58,0.61,HEPA,120t,10,b
AC,363,1PH,12,0.4,396,2.27,83,66,0.6,HEPA,120t,9,b
BLDC,420,1PH,10,0.4,393,2.23,89,61,0.6,HEPA,120t,9,b
AC,330,3PH,11,0.4,393,2.26,83,63,0.6,HEPA,75t,9,b
AC,290,3PH,10,0.4,392,2.22,84,66,0.6,ULPA,75t,8,b
BLDC,297,3PH,12,0.4,390,2.2,84,64,0.6,ULPA,75t,9.5,b
AC,284,3PH,13,0.2,384,1.54,78,63,0.59,HEPA,75t,9,b
AC,387,3PH,13,0.4,374,2.17,78,60,0.59,ULPA,120t,9.5,b
AC,283,3PH,10,0.4,374,2.18,75,61,0.59,HEPA,75t,10,b
BLDC,325,3PH,10,0.4,371,2.17,87,66,0.58,HEPA,75t,12.5,b
AC,385,1PH,10,0.4,366,2.17,82,60,0.58,HEPA,75t,12,b
BLDC,368,1PH,11,0.4,364,2.16,84,59,0.58,ULPA,75t,15,b
AC,190,3PH,12,0.4,290,2.1,76,48,0.51,HEPA,120t,14,b
BLDC,377,1PH,13,0.5,221,1.94,81,44,0.44,HEPA,120t,13.5,b
AC,400,1PH,11,0.2,300,1.4,88,49,0.46,HEPA,75t,13,b
BLDC,367,3PH,17,0.1,384,1.1,87,50,0.47,ULPA,75t,12.5,b
AC,280,1PH,16,0.5,354,1.55,78,61,0.41,HEPA,120t,12,b
BLDC,270,1PH,17,0.6,358,1.67,69,62,0.46,HEPA,120t,11.5,b
AC,300,3PH,19,0.4,360,1.87,88,58,0.42,HEPA,75t,12.5,b
BLDC,365,1PH,10,0.5,371,1.51,59,55,0.47,ULPA,75t,11.5,b
AC,244,3PH,12,0.4,299,1.44,67,57,0.52,HEPA,120t,11,b
BLDC,216,3PH,13,0.7,387,2.23,81,48,0.41,HEPA,120t,14,b
AC,311,1PH,18,0.5,284,2.55,82,55,0.44,HEPA,75t,10,b
BLDC,291,1PH,17,0.1,274,2.27,52,59,0.41,ULPA,75t,10.5,b
AC,289,3PH,16,0.15,266,1.9,62,60,0.4,HEPA,120t,11.5,b
BLDC,275,1PH,14,0.3,297,1.88,55,51,0.38,HEPA,120t,11,b
BLDC,300,1PH,10,0.4,356,2.16,91,58,0.57,ULPA,120t,11.5,b
BLDC,407,1PH,10,0.4,355,2.16,86,65,0.56,HEPA,120t,12.5,b
BLDC,372,1PH,10,0.4,354,2.14,89,58,0.55,ULPA,120t,12.5,b
AC,397,3PH,10,0.4,350,2.14,89,60,0.55,HEPA,120t,12.5,b
AC,298,3PH,11,0.4,346,2.09,78,64,0.55,ULPA,120t,12.5,b
BLDC,415,1PH,12,0.3,313,1.98,85,59,0.52,ULPA,75t,12.5,b
AC,417,1PH,12,0.3,307,1.97,93,58,0.52,HEPA,120t,13,b
BLDC,328,3PH,10,0.3,307,1.98,83,58,0.51,ULPA,120t,13.5,b
AC,324,3PH,10,0.3,305,1.96,88,63,0.51,ULPA,120t,12,b
BLDC,362,3PH,10,0.3,303,1.96,89,62,0.5,ULPA,120t,11,b
AC,420,3PH,13,0.3,299,1.92,80,63,0.5,HEPA,120t,10,b
BLDC,386,3PH,13,0.3,299,1.95,94,64,0.49,HEPA,120t,10,b
BLDC,396,3PH,11,0.3,297,1.92,94,61,0.49,HEPA,75t,12.5,b
AC,323,1PH,12,0.3,296,1.91,82,66,0.49,ULPA,75t,10.5,b
BLDC,286,3PH,10,0.3,296,1.91,78,64,0.49,HEPA,120t,10.5,b
BLDC,293,3PH,13,0.2,250,1.68,81,65,0.45,ULPA,120t,12.5,b
AC,389,1PH,13,0.2,246,1.64,95,60,0.45,ULPA,120t,10,b
AC,369,1PH,10,0.2,242,1.63,91,65,0.45,HEPA,75t,10,b
AC,338,3PH,10,0.2,239,1.62,94,66,0.45,ULPA,75t,10,b
AC,411,3PH,12,0.2,236,1.58,86,63,0.44,HEPA,75t,10.5,b
BLDC,398,3PH,13,0.2,235,1.56,93,60,0.44,HEPA,120t,12.5,b
AC,307,3PH,10,0.2,231,1.55,92,61,0.44,ULPA,120t,11,b
AC,405,1PH,13,0.2,218,1.52,80,58,0.43,HEPA,120t,11,b
BLDC,302,3PH,12,0.2,218,1.53,86,66,0.43,HEPA,75t,11,b
AC,499,3PH,9,0.6,544,1.82,71,57,0.57,HEPA,75t,12.5,c
BLDC,430,1PH,8,0.7,526,2.84,70,60,0.66,HEPA,120t,12.5,c
BLDC,522,3PH,10,0.4,510,2.25,65,59,0.76,ULPA,75t,12.5,c
AC,488,3PH,11,0.45,492,2.78,59,49,0.95,ULPA,75t,12.5,c
BLDC,458,1PH,7,0.55,490,1.88,88,48,0.72,HEPA,120t,12.5,c
BLDC,476,3PH,9,0.6,491,1.68,82,51,0.74,HEPA,75t,11,c
AC,508,3PH,6,0.4,492,2.21,81,58,0.69,ULPA,75t,10,c
BLDC,421,1PH,8,0.6,481,2.16,79,47,0.91,ULPA,120t,11,c
AC,390,3PH,11,0.2,571,1.34,94,66,0.99,HEPA,120t,11,c
AC,331,1PH,13,0.5,556,2.49,78,61,0.95,HEPA,75t,11,c
BLDC,556,1PH,11,0.6,506,2.82,93,63,0.86,HEPA,75t,10.5,c
AC,546,3PH,10,0.6,504,2.81,89,56,0.86,HEPA,120t,10.5,c
BLDC,616,3PH,10,0.6,502,2.81,97,62,0.86,ULPA,120t,10.5,c
AC,630,3PH,10,0.6,500,2.81,89,50,0.86,ULPA,75t,10.5,c
BLDC,543,1PH,11,0.6,494,2.8,80,51,0.85,HEPA,120t,10.5,c
BLDC,327,3PH,13,0.5,428,2.51,84,65,0.78,HEPA,120t,10,c
BLDC,373,1PH,13,0.5,423,2.5,88,60,0.78,HEPA,75t,10.5,c
BLDC,301,1PH,12,0.5,422,2.5,78,60,0.78,HEPA,120t,10.5,c
AC,374,1PH,10,0.5,418,2.47,94,66,0.77,ULPA,75t,10.5,c
AC,407,1PH,11,0.5,416,2.46,84,66,0.77,HEPA,120t,11,c
AC,372,1PH,11,0.5,416,2.46,85,58,0.76,ULPA,120t,11,c
AC,381,3PH,10,0.5,414,2.45,79,66,0.75,HEPA,75t,10,c
AC,363,3PH,11,0.5,412,2.44,83,62,0.75,ULPA,120t,9,c
AC,376,3PH,11,0.5,411,2.43,92,61,0.74,ULPA,75t,9.5,c
BLDC,396,1PH,12,0.5,410,2.42,76,58,0.7,ULPA,120t,9.5,c
BLDC,291,3PH,11,0.5,409,2.42,78,60,0.69,HEPA,120t,10,c
AC,336,1PH,12,0.4,345,2.08,81,65,0.55,HEPA,75t,10.5,c
BLDC,379,1PH,13,0.4,344,2.08,87,59,0.55,HEPA,75t,10.5,c
AC,349,3PH,12,0.4,342,2.03,83,64,0.54,HEPA,75t,10.5,c
BLDC,415,1PH,12,0.4,341,2.02,79,63,0.54,HEPA,120t,10.5,c
AC,281,1PH,11,0.4,335,2.01,86,63,0.54,HEPA,75t,10,c
AC,365,3PH,12,0.4,334,2.01,91,64,0.54,HEPA,75t,9,c
AC,416,3PH,11,0.4,328,2.01,94,62,0.54,ULPA,120t,11,c
BLDC,325,1PH,11,0.4,319,2,95,60,0.53,ULPA,120t,11,c
BLDC,362,1PH,13,0.4,316,2,78,58,0.52,HEPA,120t,11,c
BLDC,413,1PH,12,0.3,295,1.9,88,62,0.49,HEPA,75t,11,c
AC,340,3PH,11,0.3,293,1.88,79,59,0.49,ULPA,75t,11,c
AC,396,1PH,13,0.3,290,1.87,90,59,0.49,ULPA,120t,11,c
BLDC,398,3PH,12,0.3,287,1.83,94,59,0.49,HEPA,75t,11,c
BLDC,342,1PH,11,0.3,287,1.85,93,63,0.49,ULPA,75t,11.5,c
AC,297,3PH,13,0.3,278,1.83,76,59,0.48,ULPA,120t,11,c
BLDC,329,3PH,11,0.3,277,1.83,91,60,0.48,HEPA,75t,11,c
AC,319,1PH,11,0.3,276,1.82,95,61,0.48,ULPA,120t,11,c
BLDC,310,1PH,10,0.3,276,1.81,77,60,0.48,HEPA,75t,11.5,c
BLDC,329,1PH,12,0.3,275,1.81,90,61,0.48,HEPA,120t,11.5,c
BLDC,341,1PH,13,0.3,272,1.8,93,62,0.48,ULPA,120t,11.5,c
AC,324,3PH,12,0.2,200,1.37,94,63,0.43,HEPA,75t,10,c
AC,337,1PH,13,0.2,199,1.36,84,64,0.43,HEPA,75t,10.5,c
AC,318,1PH,10,0.2,198,1.35,94,63,0.42,HEPA,75t,11,c
AC,322,3PH,13,0.2,196,1.34,85,58,0.41,ULPA,120t,12,c
BLDC,310,3PH,13,0.2,188,1.33,76,61,0.41,HEPA,75t,12,c
BLDC,339,1PH,11,0.2,186,1.31,79,61,0.4,ULPA,120t,12,c
BLDC,291,1PH,11,0.2,183,1.27,90,62,0.34,HEPA,120t,12,c
BLDC,261,3PH,18,0.2,399,1.18,69,66,0.62,ULPA,75t,11.5,d
BLDC,218,3PH,15,0.1,359,0.55,25,66,0.58,HEPA,120t,9,d
BLDC,270,1PH,13,0.2,354,1.02,55,69,0.55,ULPA,120t,9,d
AC,158,3PH,17,0.3,272,1.8,34,65,0.47,HEPA,120t,9,d
BLDC,251,1PH,14,0.3,271,1.78,84,65,0.47,ULPA,75t,10.5,d
BLDC,110,3PH,12,0.3,270,1.78,22,69,0.47,ULPA,75t,10.5,d
AC,281,3PH,16,0.3,268,1.73,48,68,0.46,HEPA,75t,8.5,d
AC,140,1PH,20,0.3,268,1.75,23,68,0.46,HEPA,75t,8,d
BLDC,143,1PH,12,0.3,267,1.72,12,69,0.45,HEPA,75t,10,d
BLDC,258,1PH,13,0.2,182,1.26,44,70,0.34,ULPA,75t,9,d
AC,130,3PH,14,0.2,176,1.21,57,70,0.34,HEPA,120t,10.5,d
BLDC,175,3PH,13,0.2,174,1.19,44,67,0.34,HEPA,75t,10,d
AC,162,1PH,16,0.2,162,1.19,81,70,0.34,ULPA,75t,9,d
AC,264,1PH,15,0.2,157,1.16,63,65,0.34,ULPA,75t,9.5,d
AC,263,3PH,17,0.2,149,1.12,35,67,0.33,ULPA,120t,6,d
AC,293,1PH,16,0.2,148,1.11,45,68,0.31,HEPA,75t,10,d
BLDC,318,3PH,14,0.2,147,1.09,16,66,0.3,HEPA,120t,10.5,d
AC,117,3PH,13,0.2,143,1.05,29,65,0.3,HEPA,75t,11,d
AC,318,3PH,14,0.2,132,1.02,59,66,0.3,HEPA,75t,7,d
BLDC,189,1PH,20,0.2,107,0.98,74,70,0.3,HEPA,75t,11,d
BLDC,163,1PH,14,0.2,102,0.94,37,68,0.29,HEPA,120t,10,d
AC,118,3PH,14,0.2,99,0.93,15,65,0.24,HEPA,75t,10.5,d
BLDC,306,3PH,13,0.2,95,0.91,75,66,0.23,HEPA,120t,7,d
BLDC,210,3PH,14,0.1,67,0.73,19,67,0.08,ULPA,75t,9,d
BLDC,111,1PH,13,0.1,60,0.68,49,66,0.07,HEPA,75t,8,d
BLDC,161,3PH,14,0.1,58,0.56,35,66,0.06,HEPA,75t,7,d
AC,152,3PH,17,0.1,54,0.55,29,68,0.06,HEPA,120t,8.5,d
AC,177,1PH,19,0.1,53,0.5,20,65,0.05,HEPA,75t,7.5,d
BLDC,173,1PH,14,0.1,44,0.42,59,68,0.05,ULPA,120t,9,d
AC,145,3PH,19,0.1,39,0.37,75,66,0.04,HEPA,75t,9,d
AC,253,3PH,15,0.2,326,0.84,44,70,0.53,ULPA,75t,8,e
AC,205,3PH,12,0.3,267,1.7,35,68,0.45,HEPA,75t,7.5,e
BLDC,113,1PH,17,0.3,261,1.69,71,69,0.45,ULPA,75t,7,e
BLDC,286,1PH,18,0.2,92,0.91,60,66,0.23,ULPA,120t,7.5,e
AC,318,3PH,15,0.2,84,0.89,18,66,0.21,ULPA,75t,7,e
BLDC,137,3PH,15,0.2,77,0.84,45,70,0.11,ULPA,120t,9,e
BLDC,299,1PH,13,0.2,75,0.74,34,68,0.08,HEPA,75t,7.5,e
AC,263,1PH,14,0.1,39,0.32,55,65,0.04,HEPA,75t,8.5,e
AC,175,3PH,17,0.1,38,0.31,64,70,0.04,ULPA,75t,7,e
AC,240,1PH,20,0.1,33,0.29,16,70,0.05,ULPA,75t,8,e
AC,184,3PH,15,0.2,31,0.26,43,64,0.03,HEPA,75t,7,e
AC,156,1PH,12,0.1,41,0.26,43,71,0.02,HEPA,120t,8,e
AC,221,3PH,14,0.3,49,0.26,43,78,0.01,HEPA,120t,8,e
AC,199,3PH,15,0.4,37,0.26,43,67,0.03,HEPA,7t,7,e
AC,206,1PH,16,0.1,40,0.26,43,54,0.04,ULPA,120t,9,e
AC,188,1PH,18,0.2,41,0.26,43,72,0.03,ULPA,120t,7,e
AC,207,1PH,19,0.1,36,0.26,43,62,0.01,HEPA,75t,8,e
AC,199,3PH,20,0.5,39,0.26,43,71,0.03,HEPA,120t,8.5,e
AC,213,1PH,12,0.1,32,0.26,43,51,0.01,ULPA,75t,9,e
AC,203,1PH,11,0.3,42,0.26,43,58,0.02,ULPA,75t,9,e
AC,172,3PH,10,0.1,45,0.26,43,50,0.03,ULPA,75t,9,e

"""

st.header("제조기업")
st.info("생산 데이터에 대한 내용을 파악하는 Q&A 로봇입니다.")
st.error("생산 데이터에 대한 내용이 적용되어 있습니다.")

if "messages" not in st.session_state: # session_state 기존의 내용을 저장 해놓는 것
    st.session_state["messages"] = [ChatMessage(role="assistant", content="안녕하세요! Q&A 로봇입니다. 어떤 내용이 궁금하신가요?")]

for msg in st.session_state.messages:
    st.chat_message(msg.role).write(msg.content)

if prompt := st.chat_input(): # := 인풋 내용을 간단하게 작성한 명령어
    
    st.session_state.messages.append(ChatMessage(role="user", content=prompt))
    st.chat_message("user").write(prompt)

    if not API_KEY:
        st.info("Please add your OpenAI API key to continue.")
        st.stop()

    with st.chat_message("assistant"):
        stream_handler = StreamHandler(st.empty())
        llm = ChatOpenAI(openai_api_key=API_KEY, streaming=True, callbacks=[stream_handler], model_name=MODEL)
        response = llm([ ChatMessage(role="system", content=want_to.format(content))]+st.session_state.messages)
        st.session_state.messages.append(ChatMessage(role="assistant", content=response.content))